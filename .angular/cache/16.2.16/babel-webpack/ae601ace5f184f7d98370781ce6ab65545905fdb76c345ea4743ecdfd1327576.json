{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/angel/Documents/gotzon/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@services/request.service\";\nimport * as i2 from \"@app/services/correction.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@ionic/angular\";\nimport * as i5 from \"@app/services/user.service\";\nimport * as i6 from \"@app/services/sound.service\";\nimport * as i7 from \"@angular/common\";\nimport * as i8 from \"@angular/forms\";\nfunction VocabularyPage_div_1_ion_card_content_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-card-content\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.current.spanish[0], \" \");\n  }\n}\nfunction VocabularyPage_div_1_ion_button_11_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-button\", 10);\n    i0.ɵɵlistener(\"click\", function VocabularyPage_div_1_ion_button_11_Template_ion_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r5 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r5.checkResponse());\n    });\n    i0.ɵɵtext(1, \"Zuzendu\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction VocabularyPage_div_1_ion_button_12_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-button\", 10);\n    i0.ɵɵlistener(\"click\", function VocabularyPage_div_1_ion_button_12_Template_ion_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r7 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r7.continue());\n    });\n    i0.ɵɵtext(1, \"Jarraitu\");\n    i0.ɵɵelementEnd();\n  }\n}\nconst _c0 = function (a0) {\n  return {\n    \"correcting\": a0\n  };\n};\nfunction VocabularyPage_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 2)(1, \"div\", 3);\n    i0.ɵɵelement(2, \"span\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"ion-card\");\n    i0.ɵɵtemplate(4, VocabularyPage_div_1_ion_card_content_4_Template, 2, 1, \"ion-card-content\", 4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"ion-item\")(6, \"ion-textarea\", 5);\n    i0.ɵɵlistener(\"ngModelChange\", function VocabularyPage_div_1_Template_ion_textarea_ngModelChange_6_listener($event) {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r9 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r9.response = $event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(7, \"div\", 6)(8, \"div\", 7);\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(10, \"div\", 8);\n    i0.ɵɵtemplate(11, VocabularyPage_div_1_ion_button_11_Template, 2, 0, \"ion-button\", 9);\n    i0.ɵɵtemplate(12, VocabularyPage_div_1_ion_button_12_Template, 2, 0, \"ion-button\", 9);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵstyleProp(\"width\", ctx_r0.completePercent);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.current);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.response);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(9, _c0, ctx_r0.isCorrecting));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngClass\", ctx_r0.evaluationClass);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.isCorrecting, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r0.isCorrecting);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.isCorrecting);\n  }\n}\nconst _c1 = function () {\n  return [\"/home\"];\n};\nfunction VocabularyPage_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 2)(1, \"div\", 11);\n    i0.ɵɵelement(2, \"img\", 12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 13);\n    i0.ɵɵtext(4, \"\\u00A1Has completado correctamente la lecci\\u00F3n!\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"div\", 14)(6, \"ion-button\", 15);\n    i0.ɵɵtext(7, \"Volver (Etorri)\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(6);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(1, _c1));\n  }\n}\nexport let VocabularyPage = /*#__PURE__*/(() => {\n  class VocabularyPage {\n    constructor(requestService, correction, router, loadingController, activatedRoute, userService, soundService) {\n      this.requestService = requestService;\n      this.correction = correction;\n      this.router = router;\n      this.loadingController = loadingController;\n      this.activatedRoute = activatedRoute;\n      this.userService = userService;\n      this.soundService = soundService;\n      this.congratulations = false;\n    }\n    ngAfterViewInit() {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        const loader = yield _this.loadingController.create({\n          message: 'Cargando...'\n        });\n        loader.present();\n        _this.activatedRoute.params.subscribe(params => {\n          let {\n            id\n          } = params;\n          if (id) {\n            id = id.split('?')[0];\n            _this.lessonId = id;\n            _this.requestService.getVocabularyFromLesson(_this.lessonId).subscribe(data => {\n              _this.vocabulary = data;\n              _this.totalVocabulary = _this.vocabulary.length;\n              loader.dismiss();\n              _this.setCurrent();\n            }, err => {\n              loader.dismiss();\n              _this.router.navigate(['/home'], {\n                skipLocationChange: true\n              });\n            });\n          } else {\n            _this.requestService.getVocabulary().subscribe(data => {\n              _this.vocabulary = data;\n              _this.totalVocabulary = _this.vocabulary.length;\n              loader.dismiss();\n              _this.setCurrent();\n            }, err => {\n              loader.dismiss();\n              _this.router.navigate(['/home'], {\n                skipLocationChange: true\n              });\n            });\n          }\n        });\n      })();\n    }\n    setCurrent() {\n      if (this.vocabulary.length === 0) {\n        this.lessonComplete();\n      }\n      this.current = this.vocabulary.sort(() => Math.random() - 0.5).pop();\n      this.response = '';\n      this.isCorrecting = '';\n    }\n    checkResponse() {\n      let correct = false;\n      this.current.euskaraz.forEach(e => correct = correct || this.correction.compareStrings(this.response ? this.response : '', e));\n      if (correct) {\n        this.isCorrecting = ['Oso ondo! ', 'Zuzen! ', 'Egoki! '].sort(() => Math.random() - 0.5).pop();\n        this.soundService.emitSound('success');\n        this.evaluationClass = 'correct';\n        if (this.lessonId) {\n          this.completePercent = (this.totalVocabulary - this.vocabulary.length) * 100 / this.totalVocabulary + '%';\n        }\n      } else {\n        this.isCorrecting = `Akats: ${this.current.euskaraz[0]}`;\n        this.soundService.emitSound('fail');\n        this.evaluationClass = 'error';\n      }\n    }\n    continue() {\n      if (this.lessonId) {\n        if (this.evaluationClass === 'error') {\n          this.vocabulary.push(this.current);\n          this.isCorrecting = null;\n          this.response = '';\n          this.setCurrent();\n        } else {\n          if (this.vocabulary.length > 0) {\n            this.isCorrecting = null;\n            this.response = '';\n            this.setCurrent();\n          } else {\n            this.lessonComplete();\n          }\n        }\n      } else {\n        let correct = false;\n        this.current.euskaraz.forEach(e => correct = correct || this.correction.compareStrings(this.response ? this.response : '', e));\n        if (!correct) {\n          this.vocabulary.push(this.current);\n        }\n        this.setCurrent();\n      }\n    }\n    onKeyPress(event) {\n      if (event.keyCode === 13) {\n        event.preventDefault();\n        if (this.isCorrecting && this.isCorrecting.length > 0) {\n          this.continue();\n        } else {\n          this.checkResponse();\n        }\n      }\n    }\n    lessonComplete() {\n      this.congratulations = true;\n      this.completePercent = '100%';\n      this.soundService.emitSound('complete');\n      this.userService.setVocabularyCompleted(Number(this.lessonId));\n    }\n    static #_ = this.ɵfac = function VocabularyPage_Factory(t) {\n      return new (t || VocabularyPage)(i0.ɵɵdirectiveInject(i1.RequestService), i0.ɵɵdirectiveInject(i2.CorrectionService), i0.ɵɵdirectiveInject(i3.Router), i0.ɵɵdirectiveInject(i4.LoadingController), i0.ɵɵdirectiveInject(i3.ActivatedRoute), i0.ɵɵdirectiveInject(i5.UserService), i0.ɵɵdirectiveInject(i6.SoundService));\n    };\n    static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: VocabularyPage,\n      selectors: [[\"app-vocabulary\"]],\n      decls: 3,\n      vars: 3,\n      consts: [[3, \"fullscreen\", \"keyup\"], [\"class\", \"page-container\", 4, \"ngIf\"], [1, \"page-container\"], [1, \"percent-complete\"], [4, \"ngIf\"], [3, \"ngModel\", \"ngModelChange\"], [1, \"correcting-container\", 3, \"ngClass\"], [1, \"evaluation\", 3, \"ngClass\"], [1, \"buttons-container\", \"correcting-buttons\"], [\"expand\", \"block\", 3, \"click\", 4, \"ngIf\"], [\"expand\", \"block\", 3, \"click\"], [1, \"zorionak-picture\"], [\"src\", \"img/icons/congratulations.png\"], [1, \"correct\"], [1, \"buttons-container\"], [\"expand\", \"block\", \"routerDirection\", \"root\", \"skipLocationChange\", \"\", 3, \"routerLink\"]],\n      template: function VocabularyPage_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"ion-content\", 0);\n          i0.ɵɵlistener(\"keyup\", function VocabularyPage_Template_ion_content_keyup_0_listener($event) {\n            return ctx.onKeyPress($event);\n          });\n          i0.ɵɵtemplate(1, VocabularyPage_div_1_Template, 13, 11, \"div\", 1);\n          i0.ɵɵtemplate(2, VocabularyPage_div_2_Template, 8, 2, \"div\", 1);\n          i0.ɵɵelementEnd();\n        }\n        if (rf & 2) {\n          i0.ɵɵproperty(\"fullscreen\", true);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", !ctx.congratulations);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ctx.congratulations);\n        }\n      },\n      dependencies: [i7.NgClass, i7.NgIf, i8.NgControlStatus, i8.NgModel, i3.RouterLink, i4.IonButton, i4.IonCard, i4.IonCardContent, i4.IonContent, i4.IonItem, i4.IonTextarea, i4.TextValueAccessor, i4.RouterLinkDelegate],\n      styles: [\".page-container[_ngcontent-%COMP%]{padding:78px 2% 0!important;display:flex;flex-direction:column;height:98%}.page-container[_ngcontent-%COMP%]   .percent-complete[_ngcontent-%COMP%]{position:relative;width:100%;background-color:#fff;height:10px;top:-18px;left:0;margin:0 -2%;border-radius:5px}.page-container[_ngcontent-%COMP%]   .percent-complete[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;background:repeating-linear-gradient(45deg,var(--ion-color-success),var(--ion-color-success) 10px,var(--ion-color-success-shade) 10px,var(--ion-color-success-shade) 20px);height:100%;border-radius:5px;box-shadow:13px 3px 61px -8px #00000078;transition:width 1s ease-in-out}.page-container[_ngcontent-%COMP%]   .correcting-container[_ngcontent-%COMP%]{position:relative;left:-100vw;transition:all .5s cubic-bezier(.68,-.55,.27,1.55)}.page-container[_ngcontent-%COMP%]   .correcting-container.correcting[_ngcontent-%COMP%]{left:0}.page-container[_ngcontent-%COMP%]   .correcting-container[_ngcontent-%COMP%]   .evaluation[_ngcontent-%COMP%]{padding:15px;width:-moz-fit-content;width:fit-content;border-radius:5px;min-height:55px;margin:8px 8px 8px 110px}.page-container[_ngcontent-%COMP%]   .correcting-container[_ngcontent-%COMP%]   .evaluation.error[_ngcontent-%COMP%]{background-color:var(--ion-color-danger);min-width:94px}.page-container[_ngcontent-%COMP%]   .correcting-container[_ngcontent-%COMP%]   .evaluation.correct[_ngcontent-%COMP%]{background-color:var(--ion-color-success);min-width:94px}.page-container[_ngcontent-%COMP%]   .correcting-container[_ngcontent-%COMP%]   .evaluation[_ngcontent-%COMP%]:before{content:\\\"\\\";position:absolute;top:58px;left:145px;width:0;border-left:0px solid transparent;border-right:18px solid transparent}.page-container[_ngcontent-%COMP%]   .correcting-container[_ngcontent-%COMP%]   .evaluation.error[_ngcontent-%COMP%]:before{border-top:22px solid var(--ion-color-danger)}.page-container[_ngcontent-%COMP%]   .correcting-container[_ngcontent-%COMP%]   .evaluation.correct[_ngcontent-%COMP%]:before{border-top:22px solid var(--ion-color-success)}.page-container[_ngcontent-%COMP%]   .correcting-container[_ngcontent-%COMP%]:after{position:relative;right:0;background-image:url(https://raw.githubusercontent.com/litospayaso/gotzon/master/src/img/assets/B2.svg);background-size:225px 275px;display:inline-block;width:225px;height:275px;content:\\\"\\\"}.page-container[_ngcontent-%COMP%]   .audio-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}.page-container[_ngcontent-%COMP%]   .audio-container[_ngcontent-%COMP%]   .play-button[_ngcontent-%COMP%]{min-width:unset;display:flex;align-items:center;justify-content:center;color:#4c4c4c;margin-right:16px}.page-container[_ngcontent-%COMP%]   .audio-container[_ngcontent-%COMP%]   .play-button[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:0}.page-container[_ngcontent-%COMP%]   audio[_ngcontent-%COMP%]{visibility:hidden;height:0px}.page-container[_ngcontent-%COMP%]   .buttons-container[_ngcontent-%COMP%]{margin-top:auto}.page-container[_ngcontent-%COMP%]   .zorionak-picture[_ngcontent-%COMP%]{text-align:center}\"]\n    });\n  }\n  return VocabularyPage;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}